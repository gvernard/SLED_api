{% load static %}

{% if stream %}
<table class="jb-activity">
  <tbody>
    {% for action in stream %}
    <tr class="sled-action-row">
      <!-- <td><a href="/sled_actions/view/{{ action.pk }}"><img src="{% static 'icons/box-arrow-up-right.svg' %}" alt="link"></a></td> -->
      <td>{{ action.timestamp|timesince }} ago</td>
      <td>{{ action.actor }}</td>
      <td>{{ action.verb }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div style="display:none">
  {% for action in stream %}
  <div id="tooltip-{{ forloop.counter0 }}">
    {% if action.data.action_type == "Add" %}
    <!-- <a href="{% url 'lenses:lens-query' %}?collection_ids={{ action.action_object.pk }}" target="_blank"> -->
    <a href="{{ action.action_object.get_absolute_url }}" target="_blank">
      {{ action.action_object.myitems.all|length }} new {{ action.action_object.item_type }}
    </a>
    were added by user
    <a href="{{ action.actor.get_absolute_url }}" target="_blank">
      {{ action.actor }}
    </a>
    at <em>{{ action.timestamp }}</em>
    {% elif action.data.action_type == "AddData" %}
    action_object.collection
    {% elif action.data.action_type == "UpdateSelf" %}
    object_type (Lenses,SledGroup,Collection)
    fields (json, dirty-field)
    {% elif action.data.action_type == "Update" %}
    action_object.collection
    {% elif action.data.action_type == "DeleteObject" %}
    object_type
    object_names
    {% elif action.data.action_type == "RemovedFromGroup" %}
    NONE
    {% elif action.data.action_type == "AddedToGroup" %}
    NONE
    {% elif action.data.action_type == "LeftGroup" %}
    NONE
    {% elif action.data.action_type == "RemovedFromCollection" %}
    action_object.collection
    {% elif action.data.action_type == "AddedToCollection" %}
    action_object.collection
    {% elif action.data.action_type == "MadePublic" %}
    action_object.collection
    {% elif action.data.action_type == "MadePublicGroup" %}
    action_object.collection
    {% elif action.data.action_type == "RevokeAccess" %}
    action_object.collection
    {% elif action.data.action_type == "GiveAccess" %}
    action_object.collection
    {% elif action.data.action_type == "CedeOwnershipSelf" %}
    NONE
    {% elif action.data.action_type == "CedeOwnership" %}
    action_object.collection
    {% endif %}
  </div>
  {% endfor %}
</div>



<!-- <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css"> -->
<!-- <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script> -->



<link rel="stylesheet" type="text/css" href="{% static 'css/vendors/tooltipster.bundle.min.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'css/vendors/tooltipster-sideTip-shadow.min.css' %}" />
<script type="text/javascript" src="{% static 'js/tooltipster.bundle.min.js' %}"></script>
    
<script>
  $('.sled-action-row').each(function(index){
      var mycontent = $("#tooltip-"+String(index)).html();
      $(this).tooltipster({
	  position: 'left',
	  theme: 'tooltipster-shadow',
	  interactive: true,
	  contentAsHTML: true,
	  content: mycontent,
      });
  });
</script>

{% else %}
<p class="jb-homepage-activity">No activity to display</p>
{% endif %}
